# 実装状況まとめ

このドキュメントは、要件定義書とAPI設計書に基づいて、現在の実装状況をまとめたものです。

最終更新: 2025-11-15

---

## 📋 要件定義書との対応

### 4.1 コア機能一覧（MVP）

| 機能名 | 優先度 | 実装状況 | 備考 |
|--------|--------|----------|------|
| **ログイン機能** | 高 | ✅ 実装済み | Auth0認証（OIC学生限定の検証は未実装） |
| **プロフィール作成** | 高 | ✅ 実装済み | 趣味・言語・学部・性別・出身・一言対応 |
| **検索機能** | 高 | ✅ 実装済み | 趣味・興味ベースで検索可能 |
| **チャット機能** | 高 | ✅ 実装済み | WebSocketによるリアルタイム通信 |
| 匿名「会いたい」ボタン | 中 | ❌ 未実装 | - |
| AIテーマ提案 | 中 | ⚠️ 部分的 | データベースに`ai_suggested_theme`フィールドは存在するが、API未実装 |
| イベント・ミッション提示 | 中 | ❌ 未実装 | - |

### 4.2 +α 機能

| 機能名 | 優先度 | 実装状況 | 備考 |
|--------|--------|----------|------|
| 音声通話 | 低 | ❌ 未実装 | - |
| リアルタイム翻訳 | 低 | ❌ 未実装 | - |
| スタンプ機能 | 低 | ❌ 未実装 | - |

---

## 🔌 API設計書との対応

### 1. ユーザー (`/users`)

| エンドポイント | 実装状況 | ハンドラー | 備考 |
|---------------|---------|-----------|------|
| `POST /api/v1/users/register` | ✅ 実装済み | `handlers.RegisterUser` | - |
| `GET /api/v1/users/me` | ✅ 実装済み | `handlers.GetMyProfile` | - |
| `PUT /api/v1/users/me` | ✅ 実装済み | `handlers.UpdateMyProfile` | - |
| `GET /api/v1/users` | ✅ 実装済み | `handlers.SearchUsers` | 趣味・言語で検索可能 |
| `GET /api/v1/users/{userId}` | ✅ 実装済み | `handlers.GetUserProfile` | - |

### 2. 興味・趣味 (`/interests`)

| エンドポイント | 実装状況 | ハンドラー | 備考 |
|---------------|---------|-----------|------|
| `GET /api/v1/interests` | ✅ 実装済み | `handlers.GetInterests` | - |

### 3. 匿名会いたいボタン (`/meet-requests`)

| エンドポイント | 実装状況 | ハンドラー | 備考 |
|---------------|---------|-----------|------|
| `POST /api/v1/meet-requests` | ❌ 未実装 | - | 相互マッチ時にチャット作成が必要 |

**必要な実装:**
- ハンドラー: `handlers.CreateMeetRequest`
- データベース関数: `db.CreateMeetRequest`, `db.CheckMutualMatch`, `db.CreateChatFromMatch`
- ルーティング: `main.go`に追加

### 4. チャット (`/chats`, `/ws`)

| エンドポイント | 実装状況 | ハンドラー | 備考 |
|---------------|---------|-----------|------|
| `GET /api/v1/chats` | ✅ 実装済み | `handlers.GetChats` | - |
| `GET /api/v1/chats/{chatId}/messages` | ✅ 実装済み | `handlers.GetChatMessages` | - |
| `WS /ws/chat/{chatId}` | ✅ 実装済み | `handlers.WsHandler` | リアルタイムメッセージ送受信 |

### 5. イベント (`/events`)

| エンドポイント | 実装状況 | ハンドラー | 備考 |
|---------------|---------|-----------|------|
| `GET /api/v1/events` | ❌ 未実装 | - | - |
| `GET /api/v1/events/{eventId}` | ❌ 未実装 | - | - |

**必要な実装:**
- ハンドラー: `handlers.GetEvents`, `handlers.GetEvent`
- データベース関数: `db.GetEvents`, `db.GetEvent`
- モデル: `models.Event`（既にデータベースに存在する可能性）
- ルーティング: `main.go`に追加

---

## 📊 実装状況サマリー

### ✅ 実装済み（7/10 APIエンドポイント）

1. ✅ ユーザー登録・プロフィール管理（5エンドポイント）
2. ✅ 興味・趣味マスタ取得（1エンドポイント）
3. ✅ チャット機能（3エンドポイント: 2 REST + 1 WebSocket）

### ❌ 未実装（3/10 APIエンドポイント）

1. ❌ 匿名「会いたい」ボタン（1エンドポイント）
2. ❌ イベント一覧・詳細（2エンドポイント）

### ⚠️ 部分的実装

1. ⚠️ AIテーマ提案: データベースにフィールドは存在するが、API未実装

---

## 🔍 詳細な実装状況

### 認証・セキュリティ

- ✅ Auth0 JWT認証ミドルウェア統合
- ✅ 開発モード（`DISABLE_AUTH=true`）対応
- ⚠️ OIC学生限定の検証: Auth0で実装可能だが、バックエンドでの検証ロジックは未実装

### データベース

- ✅ ユーザー・プロフィール関連テーブル
- ✅ 興味・趣味マスタテーブル
- ✅ チャット・メッセージテーブル
- ✅ 匿名会いたいボタンテーブル（`anon_interest_buttons`）- API未実装
- ✅ イベントテーブル（`events`）- API未実装

### テスト・開発ツール

- ✅ テストデータ作成スクリプト（`scripts/seed.go`）
- ✅ APIテストスクリプト
- ✅ WebSocketテストクライアント
- ✅ フロントエンド実装ガイド

---

## 🎯 次の実装優先順位

### 高優先度（MVP必須）

1. **匿名「会いたい」ボタン** (`POST /api/v1/meet-requests`)
   - 相互マッチ時のチャット自動作成
   - 通知機能（将来的に）

### 中優先度

2. **イベント機能** (`GET /api/v1/events`, `GET /api/v1/events/{eventId}`)
   - イベント一覧取得
   - イベント詳細取得

3. **AIテーマ提案API**
   - チャット作成時にAIテーマを生成・設定するAPI
   - 既存チャットにテーマを追加するAPI

### 低優先度（+α機能）

4. 音声通話
5. リアルタイム翻訳
6. スタンプ機能

---

## 📝 実装時の注意事項

### 匿名「会いたい」ボタン

- データベーステーブル `anon_interest_buttons` は既に存在
- 相互マッチ時のチャット自動作成ロジックが必要
- チャット作成時に `ai_suggested_theme` を設定可能

### イベント機能

- データベーステーブル `events` は既に存在する可能性
- スキーマを確認してから実装を開始

### AIテーマ提案

- チャットテーブルに `ai_suggested_theme` フィールドは存在
- AI生成ロジックの実装が必要（外部API連携など）

---

## 📚 関連ドキュメント

- [要件定義書](./REQUIREMENTS.md)
- [API設計書](./API_SPECIFICATION.md)
- [データベース設計書](./DATABASE.md)
- [チャット機能実装状況](./CHAT_IMPLEMENTATION_STATUS.md)

